package com.revature.controllers;

import java.io.IOException;
import java.sql.Connection;
import java.sql.SQLException;
import java.util.List;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.log4j.Logger;

import com.revature.exceptions.InvalidMethodException;
import com.revature.exceptions.InvalidURIPatternException;
import com.revature.exceptions.ReadRequestException;
import com.revature.utilities.ConnectionUtility;
import com.revature.utilities.RequestUtility;

public class LoginController {
	
	private Logger log = Logger.getLogger(LoginController.class);

	public void process(HttpServletRequest req, HttpServletResponse resp, List<String> portions) throws InvalidMethodException, InvalidURIPatternException, ReadRequestException {
		Connection con = ConnectionUtility.getConnection();
		System.out.println(con.getSchema());
		if (portions.size() == 0) {
			String method = req.getMethod();
			
			if (!method.equals("POST")) {
				throw new InvalidMethodException("LoginController only accepts POST requests. Another request type was received.");
			}
			
			log.info("Attempting to process POST request");
			try {
				String body = RequestUtility.readBody(req);
				System.out.println(body);
			} catch (IOException e) {
				throw new ReadRequestException("LoginController was unable to process request");
			}
		} else {
			throw new InvalidURIPatternException("LoginController accepts 0 additional URI sections");
		}
	}
	
}
